/*!
 * captionify | semantic image caption generator library in pure JS
 *
 * Copyright 2015, Umar Bolatov
 * Released under the MIT license
 *
 * v0.1.0
 * Date: 2015-07-05
 */
!function(a){"use strict";function b(b){var e={containerSelector:"body",dataCaption:!1,figureClass:"imgFigure",figcaptionClass:"imgFigure__caption",imgClassSelector:"",mode:"overlay",inheritStyles:!0,setFigureWidth:!0};this.options=d(e,b);var f=this;a.addEventListener("load",function(b){c(f.options),a.removeEventListener("load")})}function c(a){var b,c,a=a,d=a.figcaptionClass,k="",l=a.containerSelector,m=a.dataCaption,n="",o=a.figureClass,p=a.imgClassSelector,q=a.inheritStyles,r="",s=a.mode,t=a.setFigureWidth;b=f(l),b.length>0&&(c=g(b,p),c.length>0&&c.forEach(function(a,b,c){if(r="",k=m?e(a,"data-caption"):a.alt,n=e(a,"data-link"),k&&k.length>0){var f=document.createElement("figcaption"),g=document.createElement("figure");if(n&&n.length>0&&(r=document.createElement("a"),r.href=n,r.textContent=k),g.className=o,s&&"bottom"===s){var l=d+" "+d+"--bottom";f.className=l}else f.className=d;if(t&&(g=i(a,g),a.removeAttribute("width")),q){var p=e(a,"style");p&&(a.removeAttribute("style"),g.setAttribute("style",p))}j(g,a),r?f.appendChild(r):f.textContent=k,h(f,a)}}))}function d(a,b){return b&&Object.keys(b).forEach(function(c){a[c]=b[c]}),a}function e(a,b){return a.getAttribute(b)||!1}function f(a){return document.querySelectorAll(a)}function g(a,b){var c=[],d="img";return Array.prototype.forEach.call(a,function(a){b&&(d+="."+b);var e=a.querySelectorAll(d);c.push.apply(c,e)}),c}function h(a,b){b.parentNode.insertBefore(a,b.nextSibling)}function i(a,b){var c=e(a,"width");return c&&"px"===c.substr(c.length-2)&&(b.style.width=c),b}function j(a,b){b.length||(b=[b]);for(var c=b.length-1;c>=0;c--){var d=c>0?a.cloneNode(!0):a,e=b[c],f=e.parentNode,g=e.nextSibling;d.appendChild(e),g?f.insertBefore(d,g):f.appendChild(d)}}a.Captionify=b}(window);